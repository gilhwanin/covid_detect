# COVID-19 Video Classification Project

본 프로젝트는 **COVID-19, 폐렴, 정상 영상 데이터를 활용하여 비디오 분류 모델을 구축**하는 과정입니다.  
영상 데이터를 수집, 전처리, 모델 학습 및 최적화하는 전체 파이프라인을 포함하며, 주요 단계는 다음과 같습니다.

1. **데이터 수집 및 정리**: 다양한 소스에서 영상을 수집하고, 로컬 환경에 저장
2. **데이터 전처리**: 영상에서 프레임을 추출하고, 모델 학습을 위한 형식으로 변환
3. **모델 설계 및 학습**: CNN + RNN(ConvLSTM2D) 기반의 모델을 설계하고 학습

---

## 프로젝트 구성

### 1. `Data_Preparation.ipynb` - 데이터 수집 및 구성
이 스크립트는 다음의 다양한 소스에서 COVID-19 관련 영상을 자동으로 수집하여 사용자의 로컬 환경에 저장합니다.

- **ButterflyNetwork**
- **GrepMed**
- **LITFL**
- **The PocusAtlas**
- **Radiopaedia**
- **CoreUltrasound**
- **University of Florida (UF)**
- **Scientific Publications**
- **Clarius**

#### 주요 기능
- 위 출처에서 영상 및 메타데이터를 자동으로 수집
- 데이터를 정리하고 로컬에 저장
- 비디오에서 프레임을 추출하여 학습용 이미지 데이터셋 구축

> **참고:** NRC-COVIDx-US 레포지토리에는 실제 데이터가 저장되지 않으며, 데이터를 수집·정리하는 스크립트만 포함됩니다.

---

### 2. `Data_Preprocessing.ipynb` - 데이터 전처리
수집된 영상 데이터를 CNN + LSTM 모델에서 사용할 수 있도록 정리하는 과정입니다.

#### 주요 기능
- **데이터 필터링 및 정리**
  - COVID-19, 폐렴, 정상 영상을 구분하여 정리
  - 불필요한 데이터를 제거하고 사용 가능한 영상만 선별

- **데이터 증강(Augmentation)**
  - 좌우 반전, 회전 등의 기법을 활용하여 데이터셋을 증가시킴

- **데이터셋 분할**
  - 훈련(train), 검증(validation), 테스트(test) 세트로 데이터 나누기
  - `train_test_split`을 활용하여 `70:30` 비율로 나누고, 훈련 데이터 중 `20%`를 검증 데이터로 할당

- **프레임 추출 및 저장**
  - OpenCV를 사용하여 각 비디오에서 14개의 대표적인 프레임을 추출
  - 추출된 프레임을 `(14, 224, 224, 3)` 형태로 변환하여 CNN+LSTM 모델 학습을 준비

- **데이터 저장**
  - 전처리된 데이터를 `.npy` 형식으로 저장 (`X_train`, `X_val`, `y_train`, `y_val`)

---

### 3. `Model.ipynb` - 모델 설계 및 학습
본 프로젝트에서는 **시간적 특성을 반영할 수 있는 RNN 기반 모델**을 실험하였으며, **ConvLSTM2D 모델**이 가장 적합하다고 판단하여 이를 최종적으로 채택하였습니다.

#### 모델 설계 흐름
1. **모델 조사 및 실험**
   - CNN + RNN 구조 탐색 (LSTM, GRU 등 비교)
   - ConvLSTM2D가 가장 적합한 성능을 보임

2. **모델 아키텍처 구성**
   - 입력층과 출력층을 데이터 특성에 맞춰 Fine-Tuning
   - ConvLSTM2D 레이어 추가로 시간적 특징 반영
   - Fully Connected Layer(FC)와 Softmax를 활용하여 분류

3. **모델 학습 및 평가**
   - 학습 데이터로 훈련 후 검증 데이터로 평가
   - F1-score 기반으로 정확도 및 성능 평가

4. **모델 최적화**
   - Weight Pruning 기법을 사용하여 모델 크기 최적화
   - 불필요한 가중치를 제거하여 경량화 및 성능 향상

---

## 사용된 기술
- **Python, OpenCV** : 영상 처리 및 프레임 추출
- **TensorFlow/Keras** : CNN + RNN 기반 딥러닝 모델 구현
- **NumPy, Pandas** : 데이터 관리 및 처리
- **Scikit-learn** : 데이터셋 분할 및 성능 평가
- **Matplotlib** : 데이터 시각화 및 분석

---

## 참고
- 본 저장소는 데이터 수집, 전처리, 모델 학습 및 최적화 과정을 포함합니다.
- 데이터는 **사용자의 로컬 환경에서 직접 다운로드 및 저장**해야 하며, 레포지토리에는 포함되지 않습니다.
- 이 프로젝트는 연구 및 학습 목적으로 공개되었으며, 상업적 이용을 금합니다.
